<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="/static/editPage.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
</head>
<body>
{% extends "base.html" %}
{% block content %}
<div id="app">
    <div id="main_box">
        <!-- ã‚µãƒãƒ¼ãƒˆã‚¢ã‚¤ãƒ‰ãƒ«ã®ç·¨é›† -->
        <div id="support_box" class='item'>
            <h2>ãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‰ãƒ«</h2>
            <div id="produce_box">
                <img id='produce_img' :src="`/static/img/${settings.produce_idol}/${settings.produce_card}.png`" 
                :alt="settings.produce_card+'\nNoImage'">
                <div>
                    <span>ã‚¢ã‚¤ãƒ‰ãƒ«åï¼š</span>
                    <select v-model="settings.produce_idol">
                        <option v-for="idol in all_idol" :key="idol" :value="idol">
                            [[ idol ]]
                        </option>
                    <<input type='text' v-model="settings.produce_card" placeholder="èŠ±é¢¨smiley">
                    <input class="DBbtn" type="button" value="DBã«è¿½åŠ " @click="submit_Pcard">

                </div>
            </div>

            <h2>ã‚µãƒãƒ¼ãƒˆã‚¢ã‚¤ãƒ‰ãƒ«</h2>
            <div id="support_icon_box">
                <div class="support_idol" v-for='(support,index) in settings.support_list' :key="support.card_name">
                    <input type="radio" :id="support.card_name" :value="index" v-model="Sid">
                    <label :for="support.card_name">
                        <img :src="`/static/img/${support.idol_name}/${support.card_name}.png`" 
                        :alt="support.card_name+'\nNoImage'">
                    </label>
                </div>
            </div>
            <input type="radio" name="isSearchSupport" id="isSearchSupportTrue" :value="true" v-model="isSearchSupport">
            <label for="isSearchSupportTrue">DBã‹ã‚‰æ¤œç´¢ã™ã‚‹</label>
            <input type="radio" name="isSearchSupport" id="isSearchSupportFalse" :value="false" v-model="isSearchSupport">
            <label for="isSearchSupportFalse">è‡ªåˆ†ã§ä½œæˆã™ã‚‹</label>

            <div id="support_info" v-if="isSearchSupport">
                <p>ã‚¢ã‚¤ãƒ‰ãƒ«å:
                <select v-model="Serching_support.idol" @change="updateSupport">
                    <option v-for="support in all_support" :key="support.key" :value="support.idol_name">[[ support.idol_name ]]</option>
                </select></p>
                <p>ã‚«ãƒ¼ãƒ‰å:<select v-model="Serching_support.name" @change="updateSupport">
                    <option v-for="support in filteredByIdol" :key="support.key" :value="support.card_name">[[ support.card_name ]]</option>
                </select>
                å‡¸ï¼š<select v-model="Serching_support.totu" @change="updateSupport">
                    <option v-for="support in filteredByCard" :key="support.key" :value="support.totu">[[ support.totu ]]</option>
                </select></p>
                
                <div id="support-status-box">
                    <h3>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h3>
                    <p>Vo:[[ settings.support_list[Sid].status.Vo ]] 
                        Da:[[ settings.support_list[Sid].status.Da ]]
                        Vi:[[ settings.support_list[Sid].status.Vi ]]</p>
                    <h3>ã‚¢ãƒ”ãƒ¼ãƒ«</h3>
                    <p><span v-if="settings.support_list[Sid].appeal.Vo>0">Vo[[settings.support_list[Sid].appeal.Vo]]å€</span>
                        <span v-if="settings.support_list[Sid].appeal.Da>0">Da[[settings.support_list[Sid].appeal.Da]]å€</span>
                        <span v-if="settings.support_list[Sid].appeal.Vi>0">Vi[[settings.support_list[Sid].appeal.Vi]]å€</span>
                        <span v-if="settings.support_list[Sid].appeal.Ex>0">Ex[[settings.support_list[Sid].appeal.Ex]]å€</span>
                        ã‚¢ãƒ”ãƒ¼ãƒ«</p>
                    <p v-for="buff in settings.support_list[Sid].buff">
                        [[buff.color]] [[buff.buff]]%UP [ [[buff.turn]]ã‚¿ãƒ¼ãƒ³ ]
                    </p>
                </div>
            </div>
            <div id="support_info" v-else>
                <p>ã‚¢ã‚¤ãƒ‰ãƒ«ï¼š<select v-model="settings.support_list[Sid].idol_name">
                    <option v-for="idol in all_idol" :key="idol" :value="idol">
                        [[ idol ]]
                    </option>
                </select></p>
                <p>ã‚«ãƒ¼ãƒ‰åï¼š<input type='text' v-model="settings.support_list[Sid].card_name"></p>
                <p>å‡¸ï¼š<select v-model="settings.support_list[Sid].totu">
                    <option>0å‡¸</option><option>1å‡¸</option><option>2å‡¸</option><option>3å‡¸</option><option>4å‡¸</option>
                </select></p>
                <br>
                <h3>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h3>
                Voï¼š<input type="number" v-model="settings.support_list[Sid].status.Vo" min="0">
                Daï¼š<input type="number" v-model="settings.support_list[Sid].status.Da" min="0">
                Viï¼š<input type="number" v-model="settings.support_list[Sid].status.Vi" min="0">
                <br>
                <h3>ã‚¢ãƒ”ãƒ¼ãƒ«å€ç‡</h3>
                Voï¼š<input type="number" v-model="settings.support_list[Sid].appeal.Vo" min="0" step="0.5">
                Daï¼š<input type="number" v-model="settings.support_list[Sid].appeal.Da" min="0" step="0.5">
                Viï¼š<input type="number" v-model="settings.support_list[Sid].appeal.Vi" min="0" step="0.5">
                Exï¼š<input type="number" v-model="settings.support_list[Sid].appeal.Ex" min="0" step="0.5">
                <h3>ä»˜ä¸ã•ã‚Œã‚‹ãƒãƒ•</h3>
                <div id="support_buff_box">
                    <div id="support_buff" v-for="buff in settings.support_list[Sid].buff" :key="buff.name">
                        [[ buff.color ]] [[ buff.buff ]]%ã‚¢ãƒƒãƒ— / [[ buff.turn ]]ã‚¿ãƒ¼ãƒ³
                        <button @click="remove_buff(buff,settings.support_list[Sid].buff)">å‰Šé™¤</button>
                    </div>
                    <div id="support_buff_add">
                        <select v-model="buff_form.color">
                            <option selected disabled>--å±æ€§--</option>
                            <option value="Vo">Vo</option>
                            <option value="Da">Da</option>
                            <option value="Vi">Vi</option>
                            <option value="At">æ³¨ç›®åº¦</option>
                            <option value="Av">å›é¿ç‡</option>
                            <option value="Pa">ãƒ‘ãƒƒã‚·ãƒ–ç™ºå‹•ç‡</option>
                        </select>
                        <input type="number" v-model="buff_form.buff" min="0" step="0.5">%ã‚¢ãƒƒãƒ— /
                        <input type="number" v-model="buff_form.turn" min="0">ã‚¿ãƒ¼ãƒ³
                        <input type='text' v-model="buff_form.name" hidden>
                        <input type="button" @click="add_buff(settings.support_list[Sid].buff)" value="è¿½åŠ ">
                    </div>
                </div>
            </div>
            <div class="button-container">
                <input class="DBbtn" type="button" value="DBã«è¿½åŠ " @click="submit_support">
            </div>
        </div>

        <!-- å–å¾—æœ­ã®ç·¨é›† -->
        <div id="pweapon_box" class='item'>
            <h2>å–å¾—æœ­<input class="passive_reload_btn" type="button" value="ğŸ—˜" @click="fetch_pweapon_passive()" title="å–å¾—æœ­ã‚’èª­ã¿è¾¼ã‚€"></h2>
            <div class="pweapon" v-for='(pweapon, index) in settings.pweapon_list' :key="pweapon.card_name">
                <input type="radio" :id="pweapon.card_name +1" name="weapon" :value="index" v-model="Pid">
                <label :for="pweapon.card_name+1">
                    <p>[[ pweapon.card_name ]]
                    </p>
                    <p class='card_explain'>
                        <span v-if='pweapon.ATKtype == "whole"'>å…¨è¦³å®¢ã«</span>
                        <span v-for='(rate,col) in pweapon.weapon_rate'>
                            <span v-if='[[rate]]>0'>[[col]][[rate]]å€</span>
                        </span>
                        <span>ã‚¢ãƒ”ãƒ¼ãƒ«</span>
                    </p>
                </label>
            </div>

            <input type="radio" name="isSearchPweapon" id="isSearchPweaponTrue" :value="true" v-model="isSearchPweapon">
            <label for="isSearchPweaponTrue">DBã‹ã‚‰æ¤œç´¢ã™ã‚‹</label>
            <input type="radio" name="isSearchPweapon" id="isSearchPweaponFalse" :value="false" v-model="isSearchPweapon">
            <label for="isSearchPweaponFalse">è‡ªåˆ†ã§ä½œæˆã™ã‚‹</label>
            <div id="pweapon_editbox" v-if="isSearchPweapon">
                <select v-model="settings.pweapon_list[Pid]">
                    <option v-for="pweapon in all_pweapon" :key="pweapon.card_name" :value="pweapon">[[ pweapon.card_name ]]</option>
                </select>

                <p>[[settings.pweapon_list[Pid].card_name]]</p>
                <p><span v-if="settings.pweapon_list[Pid].ATKtype==='whole'">å…¨è¦³å®¢ã«</span>
                <span v-if="settings.pweapon_list[Pid].weapon_rate.Vo>0">Vo[[settings.pweapon_list[Pid].weapon_rate.Vo]]å€</span>
                <span v-if="settings.pweapon_list[Pid].weapon_rate.Da>0">Da[[settings.pweapon_list[Pid].weapon_rate.Da]]å€</span>
                <span v-if="settings.pweapon_list[Pid].weapon_rate.Vi>0">Vi[[settings.pweapon_list[Pid].weapon_rate.Vi]]å€</span>
                <span v-if="settings.pweapon_list[Pid].weapon_rate.Ex>0">Ex[[settings.pweapon_list[Pid].weapon_rate.VEx]]å€</span>
                ã‚¢ãƒ”ãƒ¼ãƒ«</p>
                <div id="serching_pweapon_buff">
                    <h3>ãƒãƒ•</h3>
                    <ul>
                        <li v-for="buff in settings.pweapon_list[Pid].buff">[[buff.color]][[buff.buff]]%UP[ [[buff.turn]]ã‚¿ãƒ¼ãƒ³ ]</li>
                    </ul>
                </div>
                <div id='serching_pweapon_link_box' v-if="settings.pweapon_list[Pid].link_type==='ATK'">
                    <h3>LINK</h3>
                    <p><span v-if="settings.pweapon_list[Pid].link_contents.Vo>0">Vo[[settings.pweapon_list[Pid].link_contents.Vo]]å€</span>
                        <span v-if="settings.pweapon_list[Pid].link_contents.Da>0">Da[[settings.pweapon_list[Pid].link_contents.Da]]å€</span>
                        <span v-if="settings.pweapon_list[Pid].link_contents.Vi>0">Vi[[settings.pweapon_list[Pid].link_contents.Vi]]å€</span>
                    è¿½æ’ƒ</p>
                </div>
                <div id='serching_pweapon_link_box' v-if="settings.pweapon_list[Pid].link_type==='buff'">
                    <h3>LINK</h3>
                    <ul>
                        <li v-for="buff in settings.pweapon_list[Pid].link_contents">[[buff.color]][[buff.buff]]%UP[ [[buff.turn]]ã‚¿ãƒ¼ãƒ³ ]</li>
                    </ul>
                </div>
            </div>

            <div id="pweapon_editbox" v-else>
                <p>ã‚«ãƒ¼ãƒ‰åï¼š<input type='text' v-model="settings.pweapon_list[Pid].card_name"></p>
                <p><input type="radio" id="single" name="ATKtype" value="single" v-model="settings.pweapon_list[Pid].ATKtype" checked><label for="single">ã‚¹ãƒ”ã‚¢æœ­</label>
                    <input type="radio" id="whole" name="ATKtype" value="whole" v-model="settings.pweapon_list[Pid].ATKtype"><label for="whole">å…¨ä½“æœ­</label></p>
                <p>å€ç‡ï¼šVo<input type='number' v-model="settings.pweapon_list[Pid].weapon_rate.Vo" min="0" step="0.5">
                    Da<input type='number' v-model="settings.pweapon_list[Pid].weapon_rate.Da" min="0" step="0.5">
                    Vi<input type='number' v-model="settings.pweapon_list[Pid].weapon_rate.Vi" min="0" step="0.5">
                    Ex<input type='number' v-model="settings.pweapon_list[Pid].weapon_rate.Ex" min="0" step="0.5">
                </p>
                ä»˜ä¸ã•ã‚Œã‚‹ãƒãƒ•
                <div id="pweapon_buff_box">
                    <div id="pweapon_buff" v-for=" buff in settings.pweapon_list[Pid].buff" :key="buff.name">
                        [[ buff.color ]] [[ buff.buff ]]%ã‚¢ãƒƒãƒ— / [[ buff.turn ]]ã‚¿ãƒ¼ãƒ³
                        <button @click="remove_buff(buff,settings.pweapon_list[Pid].buff)">å‰Šé™¤</button>
                    </div>
                    <div id="pweapon_buff_add">
                        <select v-model="buff_form.color">
                            <option selected disabled>--å±æ€§--</option>
                            <option value="Vo">Vo</option>
                            <option value="Da">Da</option>
                            <option value="Vi">Vi</option>
                            <option value="At">æ³¨ç›®åº¦</option>
                            <option value="Av">å›é¿ç‡</option>
                            <option value="Pa">ãƒ‘ãƒƒã‚·ãƒ–ç™ºå‹•ç‡</option>
                        </select>
                        <input type="number" v-model="buff_form.buff" min="0" step="0.5">%ã‚¢ãƒƒãƒ— /
                        <input type="number" v-model="buff_form.turn" min="0">ã‚¿ãƒ¼ãƒ³
                        <input type='text' v-model="buff_form.name" hidden>
                        <input type="button" @click="add_buff(settings.pweapon_list[Pid].buff)" value="è¿½åŠ ">
                    </div>
                </div>
                <!-- LINK,Plusã‚¢ãƒ”ãƒ¼ãƒ« -->
                <div id="link_box">
                    LINK
                    <p><input type="radio" id="no_link" name="lik_type" value="no_link" v-model="settings.pweapon_list[Pid].link_type" @change="prepare_link_form(settings.pweapon_list[Pid])"><label for="no_link">ãƒªãƒ³ã‚¯ãªã—</label>
                        <input type="radio" id="ATK" name="link_type" value="ATK" v-model="settings.pweapon_list[Pid].link_type" @change="prepare_link_form(settings.pweapon_list[Pid])"><label for="ATK">è¿½æ’ƒ</label>
                        <input type="radio" id="buff" name="link_type" value="buff" v-model="settings.pweapon_list[Pid].link_type" @change="prepare_link_form(settings.pweapon_list[Pid])"><label for="buff">ãƒãƒ•</label></p>
                    <div v-if="settings.pweapon_list[Pid].link_type == 'ATK'">
                        Vo<input type='number' v-model="settings.pweapon_list[Pid].link_contents.Vo" min="0" step="0.5">
                        Da<input type='number' v-model="settings.pweapon_list[Pid].link_contents.Da" min="0" step="0.5">
                        Vi<input type='number' v-model="settings.pweapon_list[Pid].link_contents.Vi" min="0" step="0.5">
                    </div>
                    <div v-if="settings.pweapon_list[Pid].link_type == 'buff'">
                        <div id="link_buff" v-for=" buff in settings.pweapon_list[Pid].link_contents" :key="buff.name">
                            [[ buff.color ]] [[ buff.buff ]]%ã‚¢ãƒƒãƒ— / [[ buff.turn ]]ã‚¿ãƒ¼ãƒ³
                            <button @click="remove_buff(buff,settings.pweapon_list[Pid].link_contents)">å‰Šé™¤</button>
                        </div>
                    
                        <div id="link_buff_add">
                            <select v-model="buff_form.color">
                                <option selected disabled>--å±æ€§--</option>
                                <option value="Vo">Vo</option>
                                <option value="Da">Da</option>
                                <option value="Vi">Vi</option>
                                <option value="At">æ³¨ç›®åº¦</option>
                                <option value="Av">å›é¿ç‡</option>
                                <option value="Pa">ãƒ‘ãƒƒã‚·ãƒ–ç™ºå‹•ç‡</option>
                            </select>
                            <input type="number" v-model="buff_form.buff" min="0" step="0.5">%ã‚¢ãƒƒãƒ— /
                            <input type="number" v-model="buff_form.turn" min="0">ã‚¿ãƒ¼ãƒ³
                            <input type='text' v-model="buff_form.name" hidden>
                            <input type="button" @click="add_buff(settings.pweapon_list[Pid].link_contents)" value="è¿½åŠ ">
                        </div>
                    </div>
                </div>
                <div class="button-container">
                    <input class="DBbtn" type="button" value="DBã«è¿½åŠ " @click="submit_pweapon">
                </div>
                
            </div>
        </div>

        <!-- ãƒ‘ãƒƒã‚·ãƒ– -->
        <div id="passive_box" class="item">
            <h2>ãƒ‘ãƒƒã‚·ãƒ–<input class="passive_reload_btn" type="button" value="ğŸ—˜" @click="fetch_pweapon_passive()" title="ãƒ‘ãƒƒã‚·ãƒ–ã‚’èª­ã¿è¾¼ã‚€"></h2>
            <div class="passive_choice" v-for="passive in all_passive" :key="passive.name">
                <label class="tooltip">
                    <input type="checkbox" :value="passive" v-model="settings.aquired_passive">
                    <p>[[passive.card_name]][[passive.type]]</p>
                    <span class="tooltiptext">[[passive.text]]</span>
                    </label>
            </div>
            <p>ã“ã“ã«ãªã„ãƒ‘ãƒƒã‚·ãƒ–ã‚’è¿½åŠ ã™ã‚‹<input class="edit_passive_btn" type="button" value="â–½" @click="toggle_edit_passive()"></p>
            <div id="add_passive" v-if="isEditPassive">
            <p>ã‚«ãƒ¼ãƒ‰åï¼š</p>
            <select v-model="passive_template.card_name" required>
                <option :value="settings.produce_card">[[ settings.produce_card ]]</option>
                <option v-for="support in settings.support_list" :key="support.card_name" :value="support.card_name">
                    [[ support.card_name ]]
                </option>
            </select>

                <select v-model="passive_template.type" required>
                    <option selected disabled>--ç¨®åˆ¥--</option>
                    <option value="ç™½1">ç™½1</option>
                    <option value="ç™½2">ç™½2</option>
                    <option value="é‡‘1">é‡‘1</option>
                    <option value="é‡‘2">é‡‘2</option>
                    <option value="è™¹">è™¹</option>
                </select></p>
            <p>ç•¥ç§°ï¼š<input type="text" v-model="passive_template.icon" placeholder="æµ·é‡‘"></p>
            æ¡ä»¶ï¼š<select v-model="passive_template.request">
                <option v-for="request in request_list" :value="request">[[request]]</option>
            </select>
            <input type="text" v-model="passive_template.args" :placeholder="args_explain[passive_template.request]" v-if="args_explain[passive_template.request]!=''" id="passive_args">
            <div id="passive_buff_box">
                ãƒ‘ãƒƒã‚·ãƒ–å†…å®¹
                <div class="passive_buff" v-for="rate in passive_template.buff">
                    [[ rate[0] ]][[ rate[1] ]]%UP
                    <input type="button" value="å‰Šé™¤" @click="remove_passive_buff(rate)">
                </div>
                <p>
                <select v-model="passive_rate[0]">
                    <option selected disabled>--å±æ€§--</option>
                    <option value="Vo">Vo</option>
                    <option value="Da">Da</option>
                    <option value="Vi">Vi</option>
                    <option value="At">æ³¨ç›®åº¦</option>
                    <option value="Av">å›é¿ç‡</option>
                    <option value="Pa">ãƒ‘ãƒƒã‚·ãƒ–ç™ºå‹•ç‡</option>
                </select>
                <input type="number" v-model="passive_rate[1]" min="0" step="5">ï¼…UP
                </p>
                <input type="button" value="è¿½åŠ " @click="add_passive_buff">
                <p>ç¢ºç‡ï¼š<input type="number" v-model="passive_template.p" min="0" step="10">ï¼…</p>
                <p>å›æ•°ï¼š<input type="number" v-model="passive_template.times" min="0">å›</p>
                
            </div>
            </div>
            <div class="button-container">
                <input class="DBbtn" type="button" value="DBã«è¿½åŠ " @click="submit_passive">
            </div>
        </div>
        
    </div>
    <!-- <pre>[[all_pweapon]]</pre> -->
    <!-- <pre>[[ settings.aquired_passive ]]</pre> -->
    <div class="button-container">
        <p>ãƒ‡ãƒƒã‚­å<input type="text" v-model="settings.deck_name" placeholder="è‡ªæœ­ãªã—DaVi"></p>
        <input class="decksubmit" type="button" value="ç·¨æˆã‚’ç™»éŒ²" @click="submit_deck">
        <input class="decksubmit" type="button" value="æˆ»ã‚‹" @click="return_simulation">
    </div>
    <div class="sidebar right" id="right-sidebar"></div>
</div>

<script src="static/editPage.js"></script>
{% endblock %}
</body>
</html>
